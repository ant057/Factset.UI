{"version":3,"sources":["core/portal/portal.ts"],"names":[],"mappings":"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","file":"core/portal/portal.js","sourcesContent":["import {\n    TemplateRef,\n    ViewContainerRef,\n    ElementRef,\n    ComponentRef,\n    Injector\n} from '@angular/core';\nimport {\n    MdNullPortalHostError,\n    MdPortalAlreadyAttachedError,\n    MdNoPortalAttachedError,\n    MdNullPortalError,\n    MdPortalHostAlreadyDisposedError,\n    MdUnknownPortalTypeError\n} from './portal-errors';\nimport {ComponentType} from '../overlay/generic-component-type';\n\n\n\n/**\n * A `Portal` is something that you want to render somewhere else.\n * It can be attach to / detached from a `PortalHost`.\n */\nexport abstract class Portal<T> {\n  private _attachedHost: PortalHost;\n\n  /** Attach this portal to a host. */\n  attach(host: PortalHost): T {\n    if (host == null) {\n      throw new MdNullPortalHostError();\n    }\n\n    if (host.hasAttached()) {\n      throw new MdPortalAlreadyAttachedError();\n    }\n\n    this._attachedHost = host;\n    return <T> host.attach(this);\n  }\n\n  /** Detach this portal from its host */\n  detach(): void {\n    let host = this._attachedHost;\n    if (host == null) {\n      throw new MdNoPortalAttachedError();\n    }\n\n    this._attachedHost = null;\n    return host.detach();\n  }\n\n  /** Whether this portal is attached to a host. */\n  get isAttached(): boolean {\n    return this._attachedHost != null;\n  }\n\n  /**\n   * Sets the PortalHost reference without performing `attach()`. This is used directly by\n   * the PortalHost when it is performing an `attach()` or `detatch()`.\n   */\n  setAttachedHost(host: PortalHost) {\n    this._attachedHost = host;\n  }\n}\n\n\n/**\n * A `ComponentPortal` is a portal that instantiates some Component upon attachment.\n */\nexport class ComponentPortal<T> extends Portal<ComponentRef<T>> {\n  /** The type of the component that will be instantiated for attachment. */\n  component: ComponentType<T>;\n\n  /**\n   * [Optional] Where the attached component should live in Angular's *logical* component tree.\n   * This is different from where the component *renders*, which is determined by the PortalHost.\n   * The origin necessary when the host is outside of the Angular application context.\n   */\n  viewContainerRef: ViewContainerRef;\n\n  /** [Optional] Injector used for the instantiation of the component. */\n  injector: Injector;\n\n  constructor(\n      component: ComponentType<T>,\n      viewContainerRef: ViewContainerRef = null,\n      injector: Injector = null) {\n    super();\n    this.component = component;\n    this.viewContainerRef = viewContainerRef;\n    this.injector = injector;\n  }\n}\n\n\n/**\n * A `TemplatePortal` is a portal that represents some embedded template (TemplateRef).\n */\nexport class TemplatePortal extends Portal<Map<string, any>> {\n  /** The embedded template that will be used to instantiate an embedded View in the host. */\n  templateRef: TemplateRef<any>;\n\n  /** Reference to the ViewContainer into which the template will be stamped out. */\n  viewContainerRef: ViewContainerRef;\n\n  /**\n   * Additional locals for the instantiated embedded view.\n   * These locals can be seen as \"exports\" for the template, such as how ngFor has\n   * index / event / odd.\n   * See https://angular.io/docs/ts/latest/api/core/EmbeddedViewRef-class.html\n   */\n  locals: Map<string, any> = new Map<string, any>();\n\n  constructor(template: TemplateRef<any>, viewContainerRef: ViewContainerRef) {\n    super();\n    this.templateRef = template;\n    this.viewContainerRef = viewContainerRef;\n  }\n\n  get origin(): ElementRef {\n    return this.templateRef.elementRef;\n  }\n\n  attach(host: PortalHost, locals?: Map<string, any>): Map<string, any> {\n    this.locals = locals == null ? new Map<string, any>() : locals;\n    return super.attach(host);\n  }\n\n  detach(): void {\n    this.locals = new Map<string, any>();\n    return super.detach();\n  }\n}\n\n\n/**\n * A `PortalHost` is an space that can contain a single `Portal`.\n */\nexport interface PortalHost {\n  attach(portal: Portal<any>): any;\n\n  detach(): any;\n\n  dispose(): void;\n\n  hasAttached(): boolean;\n}\n\n\n/**\n * Partial implementation of PortalHost that only deals with attaching either a\n * ComponentPortal or a TemplatePortal.\n */\nexport abstract class BasePortalHost implements PortalHost {\n  /** The portal currently attached to the host. */\n  private _attachedPortal: Portal<any>;\n\n  /** A function that will permanently dispose this host. */\n  private _disposeFn: () => void;\n\n  /** Whether this host has already been permanently disposed. */\n  private _isDisposed: boolean = false;\n\n  /** Whether this host has an attached portal. */\n  hasAttached() {\n    return this._attachedPortal != null;\n  }\n\n  attach(portal: Portal<any>): any {\n    if (portal == null) {\n      throw new MdNullPortalError();\n    }\n\n    if (this.hasAttached()) {\n      throw new MdPortalAlreadyAttachedError();\n    }\n\n    if (this._isDisposed) {\n      throw new MdPortalHostAlreadyDisposedError();\n    }\n\n    if (portal instanceof ComponentPortal) {\n      this._attachedPortal = portal;\n      return this.attachComponentPortal(portal);\n    } else if (portal instanceof TemplatePortal) {\n      this._attachedPortal = portal;\n      return this.attachTemplatePortal(portal);\n    }\n\n    throw new MdUnknownPortalTypeError();\n  }\n\n  abstract attachComponentPortal<T>(portal: ComponentPortal<T>): ComponentRef<T>;\n\n  abstract attachTemplatePortal(portal: TemplatePortal): Map<string, any>;\n\n  detach(): void {\n    if (this._attachedPortal) { this._attachedPortal.setAttachedHost(null); }\n\n    this._attachedPortal = null;\n    if (this._disposeFn != null) {\n      this._disposeFn();\n      this._disposeFn = null;\n    }\n  }\n\n  dispose() {\n    if (this.hasAttached()) {\n      this.detach();\n    }\n\n    this._isDisposed = true;\n  }\n\n  setDisposeFn(fn: () => void) {\n    this._disposeFn = fn;\n  }\n}\n"],"sourceRoot":"/source/"}