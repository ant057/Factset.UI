{"version":3,"sources":["core/ripple/ripple-renderer.ts"],"names":[],"mappings":"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","file":"core/ripple/ripple-renderer.js","sourcesContent":["import {\n  ElementRef,\n} from '@angular/core';\n\n/** TODO: internal */\nexport enum ForegroundRippleState {\n  NEW,\n  EXPANDING,\n  FADING_OUT,\n}\n\n/**\n * Wrapper for a foreground ripple DOM element and its animation state.\n * TODO: internal\n */\nexport class ForegroundRipple {\n  state = ForegroundRippleState.NEW;\n  constructor(public rippleElement: Element) {}\n}\n\nconst RIPPLE_SPEED_PX_PER_SECOND = 1000;\nconst MIN_RIPPLE_FILL_TIME_SECONDS = 0.1;\nconst MAX_RIPPLE_FILL_TIME_SECONDS = 0.3;\n\n/**\n * Returns the distance from the point (x, y) to the furthest corner of a rectangle.\n */\nconst distanceToFurthestCorner = (x: number, y: number, rect: ClientRect) => {\n  const distX = Math.max(Math.abs(x - rect.left), Math.abs(x - rect.right));\n  const distY = Math.max(Math.abs(y - rect.top), Math.abs(y - rect.bottom));\n  return Math.sqrt(distX * distX + distY * distY);\n};\n\n/**\n * Helper service that performs DOM manipulations. Not intended to be used outside this module.\n * The constructor takes a reference to the ripple directive's host element and a map of DOM\n * event handlers to be installed on the element that triggers ripple animations.\n * This will eventually become a custom renderer once Angular support exists.\n * TODO: internal\n */\nexport class RippleRenderer {\n  private _backgroundDiv: HTMLElement;\n  private _rippleElement: HTMLElement;\n  private _triggerElement: HTMLElement;\n\n  constructor(_elementRef: ElementRef, private _eventHandlers: Map<string, (e: Event) => void>) {\n    this._rippleElement = _elementRef.nativeElement;\n    // It might be nice to delay creating the background until it's needed, but doing this in\n    // fadeInRippleBackground causes the first click event to not be handled reliably.\n    this._backgroundDiv = document.createElement('div');\n    this._backgroundDiv.classList.add('md-ripple-background');\n    this._rippleElement.appendChild(this._backgroundDiv);\n  }\n\n  /**\n   * Installs event handlers on the given trigger element, and removes event handlers from the\n   * previous trigger if needed.\n   */\n  setTriggerElement(newTrigger: HTMLElement) {\n    if (this._triggerElement !== newTrigger) {\n      if (this._triggerElement) {\n        this._eventHandlers.forEach((eventHandler, eventName) => {\n          this._triggerElement.removeEventListener(eventName, eventHandler);\n        });\n      }\n      this._triggerElement = newTrigger;\n      if (this._triggerElement) {\n        this._eventHandlers.forEach((eventHandler, eventName) => {\n          this._triggerElement.addEventListener(eventName, eventHandler);\n        });\n      }\n    }\n  }\n\n  /**\n   * Installs event handlers on the host element of the md-ripple directive.\n   */\n  setTriggerElementToHost() {\n    this.setTriggerElement(this._rippleElement);\n  }\n\n  /**\n   * Removes event handlers from the current trigger element if needed.\n   */\n  clearTriggerElement() {\n    this.setTriggerElement(null);\n  }\n\n  /**\n   * Creates a foreground ripple and sets its animation to expand and fade in from the position\n   * given by rippleOriginLeft and rippleOriginTop (or from the center of the <md-ripple>\n   * bounding rect if centered is true).\n   */\n  createForegroundRipple(\n      rippleOriginLeft: number,\n      rippleOriginTop: number,\n      color: string,\n      centered: boolean,\n      radius: number,\n      speedFactor: number,\n      transitionEndCallback: (r: ForegroundRipple, e: TransitionEvent) => void) {\n    const parentRect = this._rippleElement.getBoundingClientRect();\n    // Create a foreground ripple div with the size and position of the fully expanded ripple.\n    // When the div is created, it's given a transform style that causes the ripple to be displayed\n    // small and centered on the event location (or the center of the bounding rect if the centered\n    // argument is true). Removing that transform causes the ripple to animate to its natural size.\n    const startX = centered ? (parentRect.left + parentRect.width / 2) : rippleOriginLeft;\n    const startY = centered ? (parentRect.top + parentRect.height / 2) : rippleOriginTop;\n    const offsetX = startX - parentRect.left;\n    const offsetY = startY - parentRect.top;\n    const maxRadius = radius > 0 ? radius : distanceToFurthestCorner(startX, startY, parentRect);\n\n    const rippleDiv = document.createElement('div');\n    this._rippleElement.appendChild(rippleDiv);\n    rippleDiv.classList.add('md-ripple-foreground');\n    rippleDiv.style.left = `${offsetX - maxRadius}px`;\n    rippleDiv.style.top = `${offsetY - maxRadius}px`;\n    rippleDiv.style.width = `${2 * maxRadius}px`;\n    rippleDiv.style.height = rippleDiv.style.width;\n    // If color input is not set, this will default to the background color defined in CSS.\n    rippleDiv.style.backgroundColor = color;\n    // Start the ripple tiny.\n    rippleDiv.style.transform = `scale(0.001)`;\n\n    const fadeInSeconds = (1 / (speedFactor || 1)) * Math.max(\n        MIN_RIPPLE_FILL_TIME_SECONDS,\n        Math.min(MAX_RIPPLE_FILL_TIME_SECONDS, maxRadius / RIPPLE_SPEED_PX_PER_SECOND));\n    rippleDiv.style.transitionDuration = `${fadeInSeconds}s`;\n\n    // https://timtaubert.de/blog/2012/09/css-transitions-for-dynamically-created-dom-elements/\n    window.getComputedStyle(rippleDiv).opacity;\n\n    rippleDiv.classList.add('md-ripple-fade-in');\n    // Clearing the transform property causes the ripple to animate to its full size.\n    rippleDiv.style.transform = '';\n    const ripple = new ForegroundRipple(rippleDiv);\n    ripple.state = ForegroundRippleState.EXPANDING;\n\n    rippleDiv.addEventListener('transitionend',\n        (event: TransitionEvent) => transitionEndCallback(ripple, event));\n  }\n\n  /**\n   * Fades out a foreground ripple after it has fully expanded and faded in.\n   */\n  fadeOutForegroundRipple(ripple: Element) {\n    ripple.classList.remove('md-ripple-fade-in');\n    ripple.classList.add('md-ripple-fade-out');\n  }\n\n  /**\n   * Removes a foreground ripple from the DOM after it has faded out.\n   */\n  removeRippleFromDom(ripple: Element) {\n    ripple.parentElement.removeChild(ripple);\n  }\n\n  /**\n   * Fades in the ripple background.\n   */\n  fadeInRippleBackground(color: string) {\n    this._backgroundDiv.classList.add('md-ripple-active');\n    // If color is not set, this will default to the background color defined in CSS.\n    this._backgroundDiv.style.backgroundColor = color;\n  }\n\n  /**\n   * Fades out the ripple background.\n   */\n  fadeOutRippleBackground() {\n    if (this._backgroundDiv) {\n      this._backgroundDiv.classList.remove('md-ripple-active');\n    }\n  }\n}\n"],"sourceRoot":"/source/"}